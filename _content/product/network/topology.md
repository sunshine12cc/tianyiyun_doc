---
---

# 网络1.0

在快速上手指南中，我们已经知道 WEB 控制台的基本用法， 但所举例子过于简单，在实际项目中，我们往往使用多台主机， 这时就涉及到如何组网的问题。 本篇指南旨在介绍如何使用 WEB 控制台来快速组织网络，实现复杂拓扑。

## 总览

为了行文方便，假设我们的任务是创建四台主机， 并两两放置在两个不同的二层网络里， 这两个二层网络还需要通过一个路由器在三层上连通，并将该路由器连接至互联网。

![](../_images/network_for_multi_instance.gif)

## 操作

第一步：创建两个二层网络

> 登录 WEB 控制台，点击左边导航条中的“计算与网络 -> 私有网络”， 在右边主显示区域点击“新建”按钮，即可创建二层网络。 分别命名为 开发环境网络 和 生产环境网络。

第二步：创建一个路由器

> 
 
> 点击左边导航条中的“计算与网络 -> 路由器”， 在右边主显示区域点击“新建”按钮，指明名称、防火墙、数量， 点击“提交”，即可。通常需要20秒左右来完成。
> 
> 虽然路由器可以复用任何防火墙， 但是强烈建议为路由器专门新建防火墙、并设立规则， 这样能更清晰地针对不同的云资源（主机或路由器） 来管理防火墙规则。
> 
> 

第三步：将两个二层网络连接至路由器

> 
> 
> 在私有网络的列表页中分别右键点击前面创建的两个二层网络， 选择”连接路由器“，在弹出的对话框中指定网络地址和路由器。 按前面总览中所设计的拓扑结构，开发环境网络使用 192.168.100.0/24 地址， 生产环境网络使用 192.168.200.0/24 地址， 它们都连接第二步中所创建的同一路由器。
> 
> 至此，我们就完成了网络拓扑，下面就可以开始创建主机了。
> 
> 

第四步：创建主机，分别放置于两个二层网络

> 创建主机的步骤已经在快速上手指南中描述过了，这里不再重复。 只有一个地方是有区别的，在指定将主机连接至哪个网络时， 不要使用默认的基础网络 vxnet-0 了， 而应该分别使用我们在第一步中创建的两个二层私有网络。

第五步：申请一个公网 IP，并分配给路由器

> 
> 
> 申请公网 IP 的操作已经在快速上手指南中描述过了，这里不再重复。
> 
> 申请到手的公网 IP 会出现在公网 IP 列表页中，右键点击它， 选择“分配到路由器”，在弹出的对话框中选定您创建的路由器，即可。
> 
> 这样，经由私有网络连接至这台路由器的主机就都能通过这台路由器 访问互联网（Internet）了。
> 
> 

第六步：将私有网络内服务暴露在互联网上

> 
> 
> 假定我们希望将主机 192.168.200.2 的 TCP 80 暴露出来， 依然使用 80 号端口，将主机 192.168.100.2 的 TCP 80 暴露出来， 并修改为 8080 号端口。
> 
> 打开路由器的详情页，在右边主显示区域里点击“端口转发”项， 再点击“添加规则”，在弹出的对话框中分别输入：
> 
>    
> | 源端口 | 内网IP | 内网端口 |
> | --- | --- | --- |
> | 8080 | 192.168.100.2 | 80 |
> | 80 | 192.168.200.2 | 80 |
> 
> 然后，点击页面上方的“应用修改”以使得刚才添加的规则生效。
> 
> **注意：请确保打开了该路由器使用的防火墙配置里的 TCP 8080 和 TCP 80 两个下行规则。**
> 
> 

第七步：清理

> 我们已经完成了组建网络拓扑的演示任务， 可以在以上各个资源的列表页中删除/销毁您不再需要的资源。
